@using Libol.SupportClass;
@using Libol.Controllers;
@{
    ViewBag.Title = "Thêm bạn đọc theo lô";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@*START------------SCRIPT FOR DATATABLES*@
<link rel="stylesheet" type="text/css" href="~/Content/DataTables/DataTables-1.10.18/css/dataTables.bootstrap4.css">
<link rel="stylesheet" type="text/css" href="~/Content/DataTables/Select-1.3.0/css/select.bootstrap4.css">
<link rel="stylesheet" type="text/css" href="~/Content/DataTables/dataTables.checkboxes.css">
<script type="text/javascript" charset="utf8" src="~/Content/DataTables/DataTables-1.10.18/js/jquery.dataTables.js"></script>
<script type="text/javascript" charset="utf8" src="~/Content/DataTables/DataTables-1.10.18/js/dataTables.bootstrap4.js"></script>
<script type="text/javascript" charset="utf8" src="~/Content/DataTables/Select-1.3.0/js/dataTables.select.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
<script>
    $(document).ready(function () {
        $('#table_patron').DataTable({

        });
        $('#table_patron1').DataTable({

        });
        $('#table_patron2').DataTable({

        });
        $('#table_patron3').DataTable({

        });
        $('#table_patron4').DataTable({

        });
        $('#table_patron5').DataTable({

        });
        $('#table_patron6').DataTable({

        });
    });
    function AddPatronByExcel() {
        $.ajax({
            url: "/Patron/AddPatronByExcel",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                //alert('Bạn đã thanh lý sản phẩm thành công');

                //alert(result);
                $.alert({
                    title: 'Thông Báo !',
                    content: result.Message,

                });


            },
            error: function () {
                alert('Thêm không thành công');
            }

        });
    }
</script>
<h4 style="margin : 1rem">Thêm bạn đọc theo lô</h4>


<div style="margin-top: 1rem">
    <h5 style="text-align: center; color:green;">Danh sách sau thiếu dữ liệu!</h5>
    <table id="table_patron" class="table table-striped table-bordered datatables">
        <thead>
            <tr>
                <th>STT</th>
                <th>Mã sinh viên</th>
                <th>Họ và tên</th>
                <th>Giới tính</th>
                <th>Ngày sinh</th>
                <th>Email</th>
                <th>Địa chỉ thường trú</th>
                <th>Chuyên ngành</th>
                <th>Điện thoại</th>
                <th>Khoá</th>
                <th>Trường</th>
                <th>Thành phố</th>
                <th>Lớp</th>
                <th>Nhóm</th>
                <th>Sửa</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in ViewBag.listPatronInValid)
            {
                <tr>
                    <td>@item.ID</td>
                    <td>@item.Code</td>
                    <td>@item.FirstName @item.MiddleName @item.LastName</td>

                    <td>@item.Sex</td>
                    <td>@item.DOB</td>
                    <td>@item.Email</td>
                    <td>@item.Address</td>
                    <td>@item.Faculty</td>
                    <td>@item.Mobile</td>
                    <td>@item.Grade</td>
                    <td>@item.College</td>
                    <td>@item.City</td>
                    <td>@item.Class</td>
                    <td>@item.PatronGroup</td>
                    <td>@Html.ActionLink("Sửa", "Edit", "Patron", new { id = item.ID }, htmlAttributes: new { @class = "btn btn-primary" })</td>
                </tr>
            }
        </tbody>

    </table>
</div>
<div style="margin-top: 1rem">
    <h5 style="text-align: center; color:green;">Danh sách sau sai ngày sinh!</h5>
    <table id="table_patron1" class="table table-striped table-bordered datatables">
        <thead>
            <tr>
                <th>STT</th>
                <th>Mã sinh viên</th>
                <th>Họ và tên</th>
                <th>Giới tính</th>
                <th>Ngày sinh</th>
                <th>Email</th>
                <th>Địa chỉ thường trú</th>
                <th>Chuyên ngành</th>
                <th>Điện thoại</th>
                <th>Khoá</th>
                <th>Trường</th>
                <th>Thành phố</th>
                <th>Lớp</th>
                <th>Nhóm</th>
                <th>Sửa</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in ViewBag.DateFail)
            {
                <tr>
                    <td>@item.ID</td>
                    <td>@item.Code</td>
                    <td>@item.FirstName @item.MiddleName @item.LastName</td>

                    <td>@item.Sex</td>
                    <td>@item.DOB</td>
                    <td>@item.Email</td>
                    <td>@item.Address</td>
                    <td>@item.Faculty</td>
                    <td>@item.Mobile</td>
                    <td>@item.Grade</td>
                    <td>@item.College</td>
                    <td>@item.City</td>
                    <td>@item.Class</td>
                    <td>@item.PatronGroup</td>
                    <td>@Html.ActionLink("Sửa", "Edit", "Patron", new { id = item.ID }, htmlAttributes: new { @class = "btn btn-primary" })</td>
                </tr>
            }
        </tbody>

    </table>
</div>
<div style="margin-top: 1rem">
    <h5 style="text-align: center; color:green;">Danh sách sau Chuyên ngành không tồn tại!</h5>
    <table id="table_patron2" class="table table-striped table-bordered datatables">
        <thead>
            <tr>
                <th>STT</th>
                <th>Mã sinh viên</th>
                <th>Họ và tên</th>
                <th>Giới tính</th>
                <th>Ngày sinh</th>
                <th>Email</th>
                <th>Địa chỉ thường trú</th>
                <th>Chuyên ngành</th>
                <th>Điện thoại</th>
                <th>Khoá</th>
                <th>Trường</th>
                <th>Thành phố</th>
                <th>Lớp</th>
                <th>Nhóm</th>
                <th>Sửa</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in ViewBag.FacultyFail)
            {
                <tr>
                    <td>@item.ID</td>
                    <td>@item.Code</td>
                    <td>@item.FirstName @item.MiddleName @item.LastName</td>

                    <td>@item.Sex</td>
                    <td>@item.DOB</td>
                    <td>@item.Email</td>
                    <td>@item.Address</td>
                    <td>@item.Faculty</td>
                    <td>@item.Mobile</td>
                    <td>@item.Grade</td>
                    <td>@item.College</td>
                    <td>@item.City</td>
                    <td>@item.Class</td>
                    <td>@item.PatronGroup</td>
                    <td>@Html.ActionLink("Sửa", "Edit", "Patron", new { id = item.ID }, htmlAttributes: new { @class = "btn btn-primary" })</td>
                </tr>
            }
        </tbody>

    </table>
</div>
<div style="margin-top: 1rem">
    <h5 style="text-align: center; color:green;">Danh sách sau Email đã tồn tại!</h5>
    <table id="table_patron3" class="table table-striped table-bordered datatables">
        <thead>
            <tr>
                <th>STT</th>
                <th>Mã sinh viên</th>
                <th>Họ và tên</th>
                <th>Giới tính</th>
                <th>Ngày sinh</th>
                <th>Email</th>
                <th>Địa chỉ thường trú</th>
                <th>Chuyên ngành</th>
                <th>Điện thoại</th>
                <th>Khoá</th>
                <th>Trường</th>
                <th>Thành phố</th>
                <th>Lớp</th>
                <th>Nhóm</th>
                <th>Sửa</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in ViewBag.EmailFail)
            {
                <tr>
                    <td>@item.ID</td>
                    <td>@item.Code</td>
                    <td>@item.FirstName @item.MiddleName @item.LastName</td>

                    <td>@item.Sex</td>
                    <td>@item.DOB</td>
                    <td>@item.Email</td>
                    <td>@item.Address</td>
                    <td>@item.Faculty</td>
                    <td>@item.Mobile</td>
                    <td>@item.Grade</td>
                    <td>@item.College</td>
                    <td>@item.City</td>
                    <td>@item.Class</td>
                    <td>@item.PatronGroup</td>
                    <td>@Html.ActionLink("Sửa", "Edit", "Patron", new { id = item.ID }, htmlAttributes: new { @class = "btn btn-primary" })</td>
                </tr>
            }
        </tbody>

    </table>
</div>
<div style="margin-top: 1rem">
    <h5 style="text-align: center; color:green;">Danh sách sau Code đã tồn tại!</h5>
    <table id="table_patron4" class="table table-striped table-bordered datatables">
        <thead>
            <tr>
                <th>STT</th>
                <th>Mã sinh viên</th>
                <th>Họ và tên</th>
                <th>Giới tính</th>
                <th>Ngày sinh</th>
                <th>Email</th>
                <th>Địa chỉ thường trú</th>
                <th>Chuyên ngành</th>
                <th>Điện thoại</th>
                <th>Khoá</th>
                <th>Trường</th>
                <th>Thành phố</th>
                <th>Lớp</th>
                <th>Nhóm</th>
                <th>Sửa</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in ViewBag.CodeFail)
            {
                <tr>
                    <td>@item.ID</td>
                    <td>@item.Code</td>
                    <td>@item.FirstName @item.MiddleName @item.LastName</td>

                    <td>@item.Sex</td>
                    <td>@item.DOB</td>
                    <td>@item.Email</td>
                    <td>@item.Address</td>
                    <td>@item.Faculty</td>
                    <td>@item.Mobile</td>
                    <td>@item.Grade</td>
                    <td>@item.College</td>
                    <td>@item.City</td>
                    <td>@item.Class</td>
                    <td>@item.PatronGroup</td>
                    <td>@Html.ActionLink("Sửa", "Edit", "Patron", new { id = item.ID }, htmlAttributes: new { @class = "btn btn-primary" })</td>
                </tr>
            }
        </tbody>

    </table>
</div>
<div style="margin-top: 1rem">
    <h5 style="text-align: center; color:green;">Danh sách sau trùng dữ liệu!</h5>
    <table id="table_patron5" class="table table-striped table-bordered datatables">
        <thead>
            <tr>
                <th>STT</th>
                <th>Mã sinh viên</th>
                <th>Họ và tên</th>
                <th>Giới tính</th>
                <th>Ngày sinh</th>
                <th>Email</th>
                <th>Địa chỉ thường trú</th>
                <th>Chuyên ngành</th>
                <th>Điện thoại</th>
                <th>Khoá</th>
                <th>Trường</th>
                <th>Thành phố</th>
                <th>Lớp</th>
                <th>Nhóm</th>
                <th>Sửa</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in ViewBag.Duplicate)
            {
                <tr>
                    <td>@item.ID</td>
                    <td>@item.Code</td>
                    <td>@item.FirstName @item.MiddleName @item.LastName</td>

                    <td>@item.Sex</td>
                    <td>@item.DOB</td>
                    <td>@item.Email</td>
                    <td>@item.Address</td>
                    <td>@item.Faculty</td>
                    <td>@item.Mobile</td>
                    <td>@item.Grade</td>
                    <td>@item.College</td>
                    <td>@item.City</td>
                    <td>@item.Class</td>
                    <td>@item.PatronGroup</td>
                    <td>@Html.ActionLink("Sửa", "Edit", "Patron", new { id = item.ID }, htmlAttributes: new { @class = "btn btn-primary" })</td>
                </tr>
            }
        </tbody>

    </table>
</div>
<div style="margin-top: 1rem">
    <h5 style="text-align: center; color:green;">Danh sách sau đã được thêm thành công!</h5>
    <table id="table_patron6" class="table table-striped table-bordered datatables">
        <thead>
            <tr>
                <th>STT</th>
                <th>Mã sinh viên</th>
                <th>Họ và tên</th>
                <th>Giới tính</th>
                <th>Ngày sinh</th>
                <th>Email</th>
                <th>Địa chỉ thường trú</th>
                <th>Chuyên ngành</th>
                <th>Điện thoại</th>
                <th>Khoá</th>
                <th>Trường</th>
                <th>Thành phố</th>
                <th>Lớp</th>
                <th>Nhóm</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in ViewBag.ListPatron)
            {
                <tr>
                    <td>@item.ID</td>
                    <td>@item.Code</td>
                    <td>@item.FirstName @item.MiddleName @item.LastName</td>

                    <td>@item.Sex</td>
                    <td>@item.DOB</td>
                    <td>@item.Email</td>
                    <td>@item.Address</td>
                    <td>@item.Faculty</td>
                    <td>@item.Mobile</td>
                    <td>@item.Grade</td>
                    <td>@item.College</td>
                    <td>@item.City</td>
                    <td>@item.Class</td>
                    <td>@item.PatronGroup</td>

                </tr>
            }
        </tbody>

    </table>
</div>
<div class="info-form" style="text-align:center">
    <p><button type="button" class="btn btn-success " onclick="AddPatronByExcel()">Thêm bạn đọc</button></p>

</div>